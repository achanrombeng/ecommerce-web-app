{% extends "base-admin.html" %} 
{% block title %}Detail Pesanan #{{ order.id }}{% endblock %}
{% block breadcrumb %}
<li>
  <div class="flex items-center">
    <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
    <a href="{{ url_for('admin_orders') }}" class="text-sm font-medium text-gray-500 hover:text-linkedin-blue">Pesanan</a>
  </div>
</li>
<li>
  <div class="flex items-center">
    <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
    <span class="text-sm font-medium text-gray-500">Edit Profil</span>
  </div>
</li>
{% endblock %}
{% block content %}

<div class="space-y-6">
  <div
    class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4"
  >
    <div>
      <h2 class="text-xl font-semibold text-gray-800">ID Pesanan: #{{ order.id }}</h2>
      <p class="text-sm text-gray-600 mt-1">Dibuat pada {{ order.created_at.strftime('%d %B %Y') }} pukul {{ order.created_at.strftime('%H:%M') }} WIB</p>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="font-semibold text-gray-800 mb-4">Informasi Pelanggan</h3>
      <div class="flex items-center gap-4 mb-4 pb-4 border-b">
        <img
          src="https://ui-avatars.com/api/?name={{ user.first_name }}+{{ user.last_name }}"
          class="w-12 h-12 rounded-full border"
        />
        <div>
          <div class="font-medium text-gray-900">{{ user.first_name }} {{ user.last_name }}</div>
          <div class="text-xs text-gray-500">{{ user.email }}</div>
        </div>
      </div>
      <div class="space-y-3">
        <span class="text-xs font-semibold text-gray-400 uppercase"
          >Alamat Pengiriman</span
        >
        <p class="text-sm text-gray-700 leading-relaxed">
          {{ user.address if user.address else 'Alamat tidak tersedia' }}<br />
          {{ user.phone if user.phone else 'Nomor telepon tidak tersedia' }}
        </p>
      </div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="font-semibold text-gray-800 mb-4">Status Transaksi</h3>
      <div class="flex items-center justify-between mb-4">
        <span class="text-sm text-gray-500">Status Saat Ini:</span>
        {% set status_colors = {
          'PENDING': 'bg-yellow-100 text-yellow-800',
          'APPROVE': 'bg-purple-100 text-purple-800', 
          'CANCEL': 'bg-red-100 text-red-800'
        } %}
        <span class="px-3 py-1 rounded-full text-xs font-bold {{ status_colors.get(order.status, 'bg-gray-100 text-gray-800') }}">
          {{ order.status.value }}
        </span>
      </div>
      <div class="text-sm text-gray-600">
        <p class="mb-2">
          <i class="fas fa-credit-card mr-2"></i> {{ order.payment_method.value if order.payment_method.value else 'Metode pembayaran tidak tersedia' }}
        </p>
      </div>
    </div>

    <div class="lg:col-span-2 space-y-6">
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="p-6 border-b border-gray-100">
          <h3 class="font-semibold text-gray-800 flex items-center gap-2">
            <i class="fas fa-box text-linkedin-blue"></i> Item Pesanan
          </h3>
        </div>
        <table class="w-full text-left">
          <thead
            class="bg-gray-50 text-xs uppercase text-gray-500 font-semibold"
          >
            <tr>
              <th class="px-6 py-4">Produk</th>
              <th class="px-6 py-4">Harga Satuan</th>
              <th class="px-6 py-4">Jumlah</th>
              <th class="px-6 py-4 text-right">Subtotal</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            {% for product_order in order.product_orders %}
            <tr>
              <td class="px-6 py-4">
  <div class="flex items-center gap-3">
    <img
      src="{{ product_order.product_image }}"
      class="w-12 h-12 rounded-md object-cover border"
      alt="{{ product_order.product.product_name }}"
    />
    <div>
      <div class="text-sm font-medium text-gray-900">
        {{ product_order.product.product_name }}
      </div>
      <div class="text-xs text-gray-500">ID: {{ product_order.product.id }}</div>
    </div>
  </div>
</td>
              <td class="px-6 py-4 text-sm">Rp {{ product_order.formatted_price }}</td>
              <td class="px-6 py-4 text-sm">{{ product_order.quantity }}</td>
              <td class="px-6 py-4 text-sm font-semibold text-right">
                Rp {{ product_order.formatted_subtotal }}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <div class="w-full space-y-3">
          <div class="flex justify-between text-gray-600">
            <span>Subtotal</span>
            <span>Rp {{ order.formatted_total }}</span>
          </div>
          <div
            class="pt-3 border-t flex justify-between text-lg font-bold text-gray-900"
          >
            <span>Total Pembayaran</span>
            <span class="text-linkedin-blue">Rp {{ order.formatted_total }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}