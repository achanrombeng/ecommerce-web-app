{% extends "base.html" %}

{% block title %}Cart - LinkedCommerce{% endblock %}

{% block content %}
<div class="bg-white rounded-lg shadow p-6">
  <h1 class="text-2xl font-bold text-linkedin-blue mb-6">
    <i class="fas fa-shopping-cart mr-2"></i>Keranjang Belanja
  </h1>
  
  <!-- Informasi Keranjang -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <p class="text-gray-700">
        <span class="font-semibold">3 produk</span> di keranjang Anda
      </p>
    </div>
    
  </div>

  <!-- Daftar Item di Keranjang -->
  <div class="space-y-4 mb-8">
    <!-- Item 1 -->
    <div class="border rounded-lg p-4 hover:bg-gray-50 transition duration-200" data-aos="fade-up">
      <div class="flex flex-col md:flex-row items-center">
        <!-- Gambar Produk -->
        <div class="w-24 h-24 flex-shrink-0">
          <img 
            src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80" 
            alt="Headphone"
            class="w-full h-full object-cover rounded"
          >
        </div>
        
        <!-- Detail Produk -->
        <div class="flex-1 md:ml-6 mt-4 md:mt-0">
          <div class="flex justify-between items-start">
            <div>
              <h3 class="font-bold text-lg">Headphone Wireless Premium</h3>
              <p class="text-gray-600 text-sm">Noise cancelling, Bluetooth 5.0</p>
              <div class="flex items-center mt-2">
                <span class="text-yellow-500">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star-half-alt"></i>
                </span>
                <span class="text-sm text-gray-600 ml-2">(4.5)</span>
              </div>
            </div>
            <div class="text-right">
              <p class="font-bold text-lg text-linkedin-blue">Rp 1.299.000</p>
              <p class="text-sm text-gray-500 line-through">Rp 1.599.000</p>
            </div>
          </div>
          
          <!-- Aksi Item -->
          <div class="flex flex-col md:flex-row md:items-center justify-between mt-4">
            <!-- Jumlah Produk -->
            <div class="flex items-center mb-4 md:mb-0">
              <button class="bg-gray-200 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-300">
                <i class="fas fa-minus text-sm"></i>
              </button>
              <span class="mx-4 font-bold text-lg">1</span>
              <button class="bg-gray-200 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-300">
                <i class="fas fa-plus text-sm"></i>
              </button>
            </div>
            
            <!-- Tombol Aksi -->
            <div class="flex space-x-2">
              <button class="flex-1 bg-linkedin-blue text-white font-medium py-3 px-6 rounded-lg hover:bg-linkedin-dark transition duration-200 flex items-center justify-center">
        <i class="fas fa-lock mr-2"></i> Lanjut ke Pembayaran
      </button>
              <button class="px-4 py-2 text-sm font-medium text-red-600 border border-red-600 rounded-md hover:bg-red-600 hover:text-white transition duration-200">
                <i class="fas fa-trash mr-1"></i> Hapus
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Ringkasan Pesanan -->
  <div class="bg-gray-50 rounded-lg p-6" data-aos="fade-up" data-aos-delay="300">
    <h2 class="text-xl font-bold text-linkedin-blue mb-4">
      <i class="fas fa-receipt mr-2"></i>Ringkasan Pesanan
    </h2>
    
    <div class="space-y-3 mb-6">
      <div class="flex justify-between">
        <span>Subtotal (3 produk)</span>
        <span class="font-medium">Rp 5.647.000</span>
      </div>
      <div class="flex justify-between">
        <span>Biaya pengiriman</span>
        <span class="font-medium text-green-600">Gratis</span>
      </div>
      <div class="flex justify-between">
        <span>Diskon</span>
        <span class="font-medium text-red-600">- Rp 309.000</span>
      </div>
      <div class="border-t pt-3">
        <div class="flex justify-between">
          <span class="font-bold">Total</span>
          <span class="font-bold text-2xl text-linkedin-blue">Rp 5.338.000</span>
        </div>
      </div>
    </div>
    
    <!-- Kupon -->
    <div class="mb-6">
      <div class="flex items-center mb-2">
        <i class="fas fa-ticket-alt text-linkedin-blue mr-2"></i>
        <span class="font-medium">Gunakan Kupon</span>
      </div>
      <div class="flex">
        <input 
          type="text" 
          placeholder="Masukkan kode kupon" 
          class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-linkedin-blue"
        >
        <button class="bg-linkedin-blue text-white px-4 py-2 rounded-r-lg hover:bg-linkedin-dark transition duration-200">
          Terapkan
        </button>
      </div>
      <div class="mt-3">
        <p class="text-sm text-gray-600 mb-2">Kupon tersedia:</p>
        <div class="flex flex-wrap gap-2">
          <button class="bg-yellow-50 border border-yellow-200 text-sm px-3 py-1 rounded-full hover:bg-yellow-100">
            <i class="fas fa-tag mr-1"></i>DISKON20%
          </button>
          <button class="bg-yellow-50 border border-yellow-200 text-sm px-3 py-1 rounded-full hover:bg-yellow-100">
            <i class="fas fa-tag mr-1"></i>GRATISONGKIR
          </button>
          <button class="bg-yellow-50 border border-yellow-200 text-sm px-3 py-1 rounded-full hover:bg-yellow-100">
            <i class="fas fa-tag mr-1"></i>WELCOME10
          </button>
        </div>
      </div>
    </div>
    
    <!-- Tombol Aksi -->
    <div class="flex flex-col md:flex-row gap-4">
      <button class="flex-1 bg-linkedin-blue text-white font-medium py-3 px-6 rounded-lg hover:bg-linkedin-dark transition duration-200 flex items-center justify-center">
        <i class="fas fa-lock mr-2"></i> Lanjut ke Pembayaran
      </button>
      <button class="flex-1 bg-white border border-linkedin-blue text-linkedin-blue font-medium py-3 px-6 rounded-lg hover:bg-linkedin-blue hover:text-white transition duration-200 flex items-center justify-center">
        <i class="fas fa-shopping-bag mr-2"></i> Lanjut Belanja
      </button>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Fungsi untuk mengupdate kuantitas produk
    const minusButtons = document.querySelectorAll('.bg-gray-200 .fa-minus').forEach(icon => {
      icon.closest('button').addEventListener('click', function() {
        const quantitySpan = this.parentElement.querySelector('span');
        let quantity = parseInt(quantitySpan.textContent);
        if (quantity > 1) {
          quantitySpan.textContent = quantity - 1;
          updateCartSummary();
        }
      });
    });

    const plusButtons = document.querySelectorAll('.bg-gray-200 .fa-plus').forEach(icon => {
      icon.closest('button').addEventListener('click', function() {
        const quantitySpan = this.parentElement.querySelector('span');
        let quantity = parseInt(quantitySpan.textContent);
        quantitySpan.textContent = quantity + 1;
        updateCartSummary();
      });
    });

    // Fungsi untuk menghapus item
    const deleteButtons = document.querySelectorAll('.fa-trash').forEach(icon => {
      icon.closest('button').addEventListener('click', function() {
        const cartItem = this.closest('.border');
        cartItem.style.opacity = '0';
        setTimeout(() => {
          cartItem.remove();
          updateCartSummary();
          // Tampilkan pesan sukses
          showFlashMessage('Item berhasil dihapus dari keranjang', 'success');
        }, 300);
      });
    });

    // Fungsi untuk menyimpan item ke wishlist
    const saveButtons = document.querySelectorAll('.fa-heart').forEach(icon => {
      icon.closest('button').addEventListener('click', function() {
        const heartIcon = this.querySelector('i');
        if (heartIcon.classList.contains('far')) {
          heartIcon.classList.remove('far');
          heartIcon.classList.add('fas');
          this.innerHTML = '<i class="fas fa-heart mr-1"></i> Tersimpan';
          showFlashMessage('Item berhasil disimpan ke wishlist', 'success');
        } else {
          heartIcon.classList.remove('fas');
          heartIcon.classList.add('far');
          this.innerHTML = '<i class="far fa-heart mr-1"></i> Simpan';
          showFlashMessage('Item dihapus dari wishlist', 'info');
        }
      });
    });

    // Fungsi untuk menambahkan produk dari rekomendasi
    const addProductButtons = document.querySelectorAll('.product-card .fa-plus').forEach(icon => {
      icon.closest('button').addEventListener('click', function() {
        const productCard = this.closest('.product-card');
        const productName = productCard.querySelector('h3').textContent;
        showFlashMessage(`${productName} berhasil ditambahkan ke keranjang`, 'success');
        
        // Animasi tombol
        this.innerHTML = '<i class="fas fa-check"></i>';
        this.classList.remove('bg-linkedin-blue');
        this.classList.add('bg-green-500');
        
        setTimeout(() => {
          this.innerHTML = '<i class="fas fa-plus"></i>';
          this.classList.remove('bg-green-500');
          this.classList.add('bg-linkedin-blue');
        }, 1500);
      });
    });

    // Fungsi untuk mengupdate ringkasan pesanan
    function updateCartSummary() {
      // Diimplementasikan dengan logika perhitungan total
      // Di sini hanya simulasi sederhana
      console.log('Ringkasan keranjang diupdate');
    }

    // Fungsi untuk menampilkan pesan flash
    function showFlashMessage(message, type) {
      const flashContainer = document.querySelector('.fixed.top-4.right-4');
      if (!flashContainer) return;
      
      const flashDiv = document.createElement('div');
      flashDiv.className = `px-6 py-4 rounded-lg shadow-lg border-l-4 ${type === 'success' ? 'bg-green-100 border-green-500 text-green-700' : 'bg-blue-100 border-blue-500 text-blue-700'}`;
      flashDiv.innerHTML = `
        <div class="flex items-center">
          <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-info-circle'} mr-3"></i>
          <span>${message}</span>
        </div>
      `;
      
      flashContainer.appendChild(flashDiv);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        flashDiv.style.transition = 'opacity 0.5s ease';
        flashDiv.style.opacity = '0';
        setTimeout(() => {
          flashDiv.remove();
        }, 500);
      }, 5000);
    }

    // Terapkan kupon
    const applyCouponBtn = document.querySelector('.bg-linkedin-blue.text-white.px-4');
    if (applyCouponBtn) {
      applyCouponBtn.addEventListener('click', function() {
        const couponInput = document.querySelector('input[placeholder="Masukkan kode kupon"]');
        const couponCode = couponInput.value.trim();
        
        if (couponCode === 'DISKON20%') {
          showFlashMessage('Kupon DISKON20% berhasil diterapkan!', 'success');
          couponInput.value = '';
        } else if (couponCode === 'GRATISONGKIR') {
          showFlashMessage('Kupon GRATISONGKIR berhasil diterapkan!', 'success');
          couponInput.value = '';
        } else if (couponCode === 'WELCOME10') {
          showFlashMessage('Kupon WELCOME10 berhasil diterapkan!', 'success');
          couponInput.value = '';
        } else if (couponCode) {
          showFlashMessage('Kupon tidak valid atau sudah kadaluarsa', 'error');
        } else {
          showFlashMessage('Masukkan kode kupon terlebih dahulu', 'error');
        }
      });
    }

    // Tombol kupon tersedia
    document.querySelectorAll('.bg-yellow-50').forEach(button => {
      button.addEventListener('click', function() {
        const couponCode = this.textContent.replace('DISKON20%', 'DISKON20%').replace('GRATISONGKIR', 'GRATISONGKIR').replace('WELCOME10', 'WELCOME10').trim();
        const couponInput = document.querySelector('input[placeholder="Masukkan kode kupon"]');
        couponInput.value = couponCode;
      });
    });
  });
</script>
{% endblock %}
